{"ast":null,"code":"import { createSlice, createAsyncThunk } from '@reduxjs/toolkit';\nimport axios from '../../../utils/axios';\nconst initialState = {\n  user: null,\n  token: null,\n  isLoading: false,\n  status: null\n};\nexport const registerUser = createAsyncThunk('auth/registerUser', async _ref => {\n  let {\n    username,\n    password\n  } = _ref;\n\n  try {\n    const {\n      data\n    } = await axios.post('/auth/register', {\n      username,\n      password\n    });\n\n    if (data.token) {\n      window.localStorage.setItem('token', data.token);\n    }\n\n    return data;\n  } catch (error) {\n    console.log(error);\n  }\n});\nexport const loginUser = createAsyncThunk('auth/loginUser', async _ref2 => {\n  let {\n    username,\n    password\n  } = _ref2;\n\n  try {\n    const {\n      data\n    } = await axios.post('/auth/login', {\n      username,\n      password\n    });\n\n    if (data.token) {\n      window.localStorage.setItem('token', data.token);\n    }\n\n    return data;\n  } catch (error) {\n    console.log(error);\n  }\n});\nexport const getMe = createAsyncThunk('auth/loginUser', async () => {\n  try {\n    const {\n      data\n    } = await axios.get('/auth/me');\n    return data;\n  } catch (error) {\n    console.log(error);\n  }\n});\nexport const authSlice = createSlice({\n  name: 'auth',\n  initialState,\n  reducers: {\n    logout: state => {\n      state.user = null;\n      state.token = null;\n      state.isLoading = false;\n      state.status = null;\n    }\n  },\n  extraReducers: {\n    // Register user\n    [registerUser.pending]: state => {\n      state.isLoading = true;\n      state.status = null;\n    },\n    [registerUser.fulfilled]: (state, action) => {\n      state.isLoading = false;\n      state.status = action.payload.message;\n      state.user = action.payload.user;\n      state.token = action.payload.token;\n    },\n    [registerUser.rejectWithValue]: (state, action) => {\n      state.status = action.payload.message;\n      state.isLoading = false;\n    },\n    // Login user\n    [loginUser.pending]: state => {\n      state.isLoading = true;\n      state.status = null;\n    },\n    [loginUser.fulfilled]: (state, action) => {\n      state.isLoading = false;\n      state.status = action.payload.message;\n      state.user = action.payload.user;\n      state.token = action.payload.token;\n    },\n    [loginUser.rejectWithValue]: (state, action) => {\n      state.status = action.payload.message;\n      state.isLoading = false;\n    },\n    // Проверка авторизации\n    [getMe.pending]: state => {\n      state.isLoading = true;\n      state.status = null;\n    },\n    [getMe.fulfilled]: (state, action) => {\n      var _action$payload, _action$payload2;\n\n      state.isLoading = false;\n      state.status = null;\n      state.user = (_action$payload = action.payload) === null || _action$payload === void 0 ? void 0 : _action$payload.user;\n      state.token = (_action$payload2 = action.payload) === null || _action$payload2 === void 0 ? void 0 : _action$payload2.token;\n    },\n    [getMe.rejectWithValue]: (state, action) => {\n      state.status = action.payload.message;\n      state.isLoading = false;\n    }\n  }\n});\nexport const checkIsAuth = state => Boolean(state.auth.token);\nexport const {\n  logout\n} = authSlice.actions;\nexport default authSlice.reducer;","map":{"version":3,"names":["createSlice","createAsyncThunk","axios","initialState","user","token","isLoading","status","registerUser","username","password","data","post","window","localStorage","setItem","error","console","log","loginUser","getMe","get","authSlice","name","reducers","logout","state","extraReducers","pending","fulfilled","action","payload","message","rejectWithValue","checkIsAuth","Boolean","auth","actions","reducer"],"sources":["C:/Users/linar/OneDrive/Документы/react-linar/blog2/client/src/redux/features/auth/authSlice.js"],"sourcesContent":["import { createSlice, createAsyncThunk } from '@reduxjs/toolkit'\r\nimport axios from '../../../utils/axios'\r\n\r\nconst initialState = {\r\n    user: null,\r\n    token: null,\r\n    isLoading: false,\r\n    status: null,\r\n}\r\n\r\nexport const registerUser = createAsyncThunk(\r\n    'auth/registerUser',\r\n    async ({ username, password }) => {\r\n        try {\r\n            const { data } = await axios.post('/auth/register', {\r\n                username,\r\n                password,\r\n            })\r\n            if (data.token) {\r\n                window.localStorage.setItem('token', data.token)\r\n            }\r\n            return data\r\n        } catch (error) {\r\n            console.log(error)\r\n        }\r\n    },\r\n)\r\n\r\nexport const loginUser = createAsyncThunk(\r\n    'auth/loginUser',\r\n    async ({ username, password }) => {\r\n        try {\r\n            const { data } = await axios.post('/auth/login', {\r\n                username,\r\n                password,\r\n            })\r\n            if (data.token) {\r\n                window.localStorage.setItem('token', data.token)\r\n            }\r\n            return data\r\n        } catch (error) {\r\n            console.log(error)\r\n        }\r\n    },\r\n)\r\n\r\nexport const getMe = createAsyncThunk('auth/loginUser', async () => {\r\n    try {\r\n        const { data } = await axios.get('/auth/me')\r\n        return data\r\n    } catch (error) {\r\n        console.log(error)\r\n    }\r\n})\r\n\r\nexport const authSlice = createSlice({\r\n    name: 'auth',\r\n    initialState,\r\n    reducers: {\r\n        logout: (state) => {\r\n            state.user = null\r\n            state.token = null\r\n            state.isLoading = false\r\n            state.status = null\r\n        },\r\n    },\r\n    extraReducers: {\r\n        // Register user\r\n        [registerUser.pending]: (state) => {\r\n            state.isLoading = true\r\n            state.status = null\r\n        },\r\n        [registerUser.fulfilled]: (state, action) => {\r\n            state.isLoading = false\r\n            state.status = action.payload.message\r\n            state.user = action.payload.user\r\n            state.token = action.payload.token\r\n        },\r\n        [registerUser.rejectWithValue]: (state, action) => {\r\n            state.status = action.payload.message\r\n            state.isLoading = false\r\n        },\r\n        // Login user\r\n        [loginUser.pending]: (state) => {\r\n            state.isLoading = true\r\n            state.status = null\r\n        },\r\n        [loginUser.fulfilled]: (state, action) => {\r\n            state.isLoading = false\r\n            state.status = action.payload.message\r\n            state.user = action.payload.user\r\n            state.token = action.payload.token\r\n        },\r\n        [loginUser.rejectWithValue]: (state, action) => {\r\n            state.status = action.payload.message\r\n            state.isLoading = false\r\n        },\r\n        // Проверка авторизации\r\n        [getMe.pending]: (state) => {\r\n            state.isLoading = true\r\n            state.status = null\r\n        },\r\n        [getMe.fulfilled]: (state, action) => {\r\n            state.isLoading = false\r\n            state.status = null\r\n            state.user = action.payload?.user\r\n            state.token = action.payload?.token\r\n        },\r\n        [getMe.rejectWithValue]: (state, action) => {\r\n            state.status = action.payload.message\r\n            state.isLoading = false\r\n        },\r\n    },\r\n})\r\n\r\nexport const checkIsAuth = (state) => Boolean(state.auth.token)\r\n\r\nexport const { logout } = authSlice.actions\r\nexport default authSlice.reducer\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}